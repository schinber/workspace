<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Student Management System{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

<script>
// 每5分钟发送一次请求刷新会话（小于超时时间）
setInterval(function() {
    // 发送一个空请求到服务器，刷新会话时间
    fetch('{{ url_for('main.keep_alive') }}')
        .then(response => response.text())
        .catch(error => console.log('保持会话失败:', error));
}, 300000); // 300000毫秒 = 5分钟
</script>
</head>


<body>
    <header>
        <div class="container">
            <h1>Student Management System</h1>
            {% if current_user.is_authenticated %}
            <nav>
                <ul>
                    {% if current_user.is_admin() %}
                    <li><a href="{{ url_for('main.admin_dashboard') }}">Dashboard</a></li>
                    <li><a href="{{ url_for('main.manage_users') }}">Manage Users</a></li>
                    <li><a href="{{ url_for('main.manage_students') }}">Manage Students</a></li>
                    {% elif current_user.is_teacher() %}
                    <li><a href="{{ url_for('main.teacher_dashboard') }}">Dashboard</a></li>
                    {% elif current_user.is_student() %}
                    <li><a href="{{ url_for('main.student_profile') }}">Profile</a></li>
                    {% endif %}
                    <li><a href="{{ url_for('main.logout') }}">Logout ({{ current_user.username }})</a></li>
                </ul>
            </nav>
            {% endif %}
        </div>
    </header>

    <main class="container">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="flash-messages">
            {% for message in messages %}
            <div class="flash-message">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Student Management System</p>
        </div>
    </footer>
</body>
</html>